<%= javascript_include_tag "http://maps.google.com/maps/api/js?sensor=true" %>
<%= javascript_include_tag "/assets/gmaps/gmaps.js?body=1", "/assets/gmaps/markerclusterer.js?body=1" %>
<%= javascript_include_tag "/assets/views/datos_ver_view.js?body=1" %>
<%= render :partial => "layouts/gmaps", :locals => { :ancho_maps => "100%", :altura_maps => "350px"} %>

<div>
  <%= link_to ('<i class="icon-py-manual"></i> Ver diccionario').html_safe, mec_custom_url(def_establecimientos111_url), :class => "pull-right btn-lg hidden-xs", :title => "Ir al diccionario" %>
  <!--<div class="pull-right btn-lg hidden-xs" id="start-tour"><a title="Ir a la ayuda"><i class="icon-py-ayuda"></i> Ayuda</a></div>-->
  <h1>
    <span itemprop="name">Proyecto 111</span>
    <meta itemprop="description"
          content="Contiene la datos del proyecto de “Ampliación y reposición de espacios escolares en 111 Establecimientos Educativos del MEC, en Asunción y 10 departamentos geográficos del país”. Dicho proyecto tiene como propósito culminar las obras iniciadas en los años 2011 y 2012 –que cuentan con contratos vigentes– considerando los requerimientos pedagógicos y socioculturales. Las intervenciones consisten en ampliar la infraestructura edilicia escolar para aumentar la capacidad del servicio educacional, sin modificación de lo existente, así como la reposición que implica la renovación parcial o total de los espacios educativos existentes. El proyecto es financiado por el Fondo para la Excelencia de la Educación y la Investigación y totaliza una inversión de 6.663.596 dólares americanos (tipo de cambio: 4.500)."/>
    <meta itemprop="temporal" style="display: none;" content="2012-01-01/2012-12-31">
    <meta itemprop="url" content="http://datos.mec.gov.py/data/establecimientos111">  
    <span itemprop="provider" itemscope itemtype="https://schema.org/Organization" style="display: none;">
      <meta itemprop="name" content="Ministerio de Educación y Cultura">
      <meta itemprop="url" content="http://www.mec.gov.py/">
      <meta itemprop="email" content="datosabiertos@mec.gov.py">
    </span>
    <span itemprop="creator" itemscope itemtype="https://schema.org/Person" style="display: none;">
      <meta itemprop="name" content="Juan Barrios">
      <meta itemprop="email" content="datosabiertos@mec.gov.py">
    </span>
    <meta itemprop="license" style="display: none;" content="https://creativecommons.org/licenses/by/4.0/legalcode"/>
    <meta itemprop="keywords" style="display: none;" content="educación,establecimientos,escolar,geografico"/>
    <meta itemprop="version" style="display: none;" content="1.0"/>
  </h1>
</div>

<%= form_tag mec_custom_url(data_establecimientos111_lista_url(nil)), :remote => true, :id => "form-buscar-establecimientos" do  %>
  <div class="table-responsive">
    <table class="table table-small-font table-bordered table-striped">
      <thead>
        <tr>

          <th rowspan="2" data-priority="4" id="ubicaciones-geograficas"> 
            <span data-titulo="true" class="hidden">Mapa</span>
            <%= link_to image_tag("marker.png", :style => "width:24px;"), "#", :id => "link-to-ubicaciones-geograficas", :class => "link-to-ubicaciones-geograficas", :title => "Haga click para ver el mapa con las instituciones de esta página." %>

          </th>

          <th rowspan="2" data-priority="1">
            <span data-titulo="true">Período</span>

            <span class="orden">
              <i class="filtro fa fa-sort"></i>
              <i class="descendente fa fa-sort-desc"></i>
              <i class="ascendente fa fa-sort-asc"></i>
            </span>

        <%= select :form_buscar_establecimientos, :anio, [2014], {}, :class => 'form-control'%>
      </th>

      <th rowspan="2" data-priority="1">
        <span data-titulo="true">Institución</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_establecimientos_nombre_institucion, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_nombre_institucion');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_establecimientos_nombre_institucion_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :nombre_institucion, 
            atributo_tipo: :text, 
            model: :Establecimiento111, 
            limit: 10,
            cadena_consulta: "nombre_institucion",
            orden: "nombre_institucion")), 
        parametro_id: "form_buscar_establecimientos_nombre_institucion", 
        resultado_id: "form_buscar_establecimientos_nombre_institucion_id",
        min_length: 3
        ) %>

      </th>

      <th rowspan="2" data-priority="1">
        <span data-titulo="true">Código Establecimiento</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_establecimientos_codigo_establecimiento, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_codigo_establecimiento');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_establecimientos_codigo_establecimiento_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :codigo_establecimiento, 
            atributo_tipo: :text, 
            model: :Establecimiento111, 
            limit: 10,
            cadena_consulta: "codigo_establecimiento",
            orden: "codigo_establecimiento")), 
        parametro_id: "form_buscar_establecimientos_codigo_establecimiento", 
        resultado_id: "form_buscar_establecimientos_codigo_establecimiento_id",
        min_length: 3
        ) %>

      </th>

      <th rowspan="2" data-priority="1">
        <span data-titulo="true">Departamento</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_establecimientos_nombre_departamento, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_nombre_departamento');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_establecimientos_nombre_departamento_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :nombre_departamento, 
            atributo_tipo: :text, 
            model: :Establecimiento111, 
            limit: 10,
            cadena_consulta: "nombre_departamento",
            orden: "nombre_departamento")), 
        parametro_id: "form_buscar_establecimientos_nombre_departamento", 
        resultado_id: "form_buscar_establecimientos_nombre_departamento_id",
        min_length: 4
        ) %>

      </th>

      <th rowspan="2" data-priority="1">
        <span data-titulo="true">Distrito</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_establecimientos_nombre_distrito, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_nombre_distrito');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_establecimientos_nombre_distrito_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :nombre_distrito, 
            atributo_tipo: :text, 
            model: :Establecimiento111, 
            limit: 10,
            cadena_consulta: "nombre_distrito",
            orden: "nombre_distrito")), 
        parametro_id: "form_buscar_establecimientos_nombre_distrito", 
        resultado_id: "form_buscar_establecimientos_nombre_distrito_id",
        min_length: 4
        ) %>

      </th>

      <th rowspan="2" data-priority="2">
        <span data-titulo="true">Zona</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_establecimientos_nombre_zona, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_nombre_zona');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_establecimientos_nombre_zona_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :nombre_zona, 
            atributo_tipo: :text, 
            model: :Establecimiento111, 
            limit: 10,
            cadena_consulta: "nombre_zona",
            orden: "nombre_zona")), 
        parametro_id: "form_buscar_establecimientos_nombre_zona", 
        resultado_id: "form_buscar_establecimientos_nombre_zona_id",
        min_length: 3
        ) %>

      </th>

      <th rowspan="2" data-priority="2">
        <span data-titulo="true">Localidad/Barrio</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_establecimientos_nombre_barrio_localidad, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_nombre_barrio_localidad');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_establecimientos_nombre_barrio_localidad_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :nombre_barrio_localidad, 
            atributo_tipo: :text, 
            model: :Establecimiento111, 
            limit: 10,
            cadena_consulta: "nombre_barrio_localidad",
            orden: "nombre_barrio_localidad")), 
        parametro_id: "form_buscar_establecimientos_nombre_barrio_localidad", 
        resultado_id: "form_buscar_establecimientos_nombre_barrio_localidad_id",
        min_length: 4
        ) %>

      </th>

      <th rowspan="2" data-priority="2">
        <span data-titulo="true">Direcci&oacute;n</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_establecimientos_direccion, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_direccion');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_establecimientos_direccion_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :direccion, 
            atributo_tipo: :text, 
            model: :Establecimiento111, 
            limit: 10,
            cadena_consulta: "direccion",
            orden: "direccion")), 
        parametro_id: "form_buscar_establecimientos_direccion", 
        resultado_id: "form_buscar_establecimientos_direccion_id",
        min_length: 4
        ) %>

      </th>

      <th rowspan="2" style="width:5%;" class="text-min number-header">
        <span data-titulo="true">Asentamientos Priorizados</span>
        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

          <%= select_tag(:form_buscar_establecimientos_asentamientos_priorizados_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
        <div class="input-group input-group-sm number-input-group">
          <%= number_field_tag :form_buscar_establecimientos_asentamientos_priorizados, nil, :class => 'form-control' %>
          <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_asentamientos_priorizados');"><i class="fa fa-times"></i></span>
        </div>
      </th>
      <th colspan="7" class="text-min">
        <%= label_tag nil, "Ampliación".html_safe%>
      </th>
      <th colspan="2" class="text-min">
        <%= label_tag nil, "Reparación".html_safe%>
      </th>
      <th colspan="2" class="text-min">
        <%= label_tag nil, "Otras Obras".html_safe%>
      </th>
      </tr>
      <tr>
        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Comedor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

            <%= select_tag(:form_buscar_establecimientos_ampliacion_comedor_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_ampliacion_comedor, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_ampliacion_comedor');"><i class="fa fa-times"></i></span>
          </div>
        </th>

        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Aulas&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

          <%= select_tag(:form_buscar_establecimientos_ampliacion_aulas_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_ampliacion_aulas, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_ampliacion_aulas');"><i class="fa fa-times"></i></span>
          </div>
        </th>

        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Aulas de Preescolar</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

          <%= select_tag(:form_buscar_establecimientos_ampliacion_aula_preescolar_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_ampliacion_aula_preescolar, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_ampliacion_aula_preescolar');"><i class="fa fa-times"></i></span>
          </div>
        </th>

        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Centro de Recursos de Aprendizaje</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

          <%= select_tag(:form_buscar_establecimientos_ampliacion_centro_aprendizaje_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_ampliacion_centro_aprendizaje, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_ampliacion_centro_aprendizaje');"><i class="fa fa-times"></i></span>
          </div>
        </th>

        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Laboratorios&nbsp;&nbsp;</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

          <%= select_tag(:form_buscar_establecimientos_ampliacion_laboratorios_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_ampliacion_laboratorios, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_ampliacion_laboratorios');"><i class="fa fa-times"></i></span>
          </div>
        </th>

        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Bloque Administrativo</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

          <%= select_tag(:form_buscar_establecimientos_ampliacion_bloque_administrativo_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_ampliacion_bloque_administrativo, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_ampliacion_bloque_administrativo');"><i class="fa fa-times"></i></span>
          </div>
        </th>

        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Servicios Higiénicos</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

          <%= select_tag(:form_buscar_establecimientos_ampliacion_servicios_higienicos_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_ampliacion_servicios_higienicos, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_ampliacion_servicios_higienicos');"><i class="fa fa-times"></i></span>
          </div>
        </th>

        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Aulas&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

          <%= select_tag(:form_buscar_establecimientos_reparacion_aulas_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_reparacion_aulas, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_reparacion_aulas');"><i class="fa fa-times"></i></span>
          </div>
        </th>

        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Servicios Higiénicos</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

          <%= select_tag(:form_buscar_establecimientos_reparacion_servicios_higienicos_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_reparacion_servicios_higienicos, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_reparacion_servicios_higienicos');"><i class="fa fa-times"></i></span>
          </div>
        </th>

        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Obras Exteriores</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

          <%= select_tag(:form_buscar_establecimientos_obras_exteriores_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_obras_exteriores, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_obras_exteriores');"><i class="fa fa-times"></i></span>
          </div>
        </th>

        <th style="width:5%;" class="text-min number-header">
          <span data-titulo="true">Cercado&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          <span class="orden">
            <i class="filtro fa fa-sort"></i>
            <i class="descendente fa fa-sort-desc"></i>
            <i class="ascendente fa fa-sort-asc"></i>
          </span>

          <%= select_tag(:form_buscar_establecimientos_cercado_operador, options_for_select(['>', '<', '=']), :class => 'form-control')%>
          <div class="input-group input-group-sm number-input-group">
            <%= number_field_tag :form_buscar_establecimientos_cercado, nil, :class => 'form-control' %>
            <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-establecimientos', '#form_buscar_establecimientos_cercado');"><i class="fa fa-times"></i></span>
          </div>
        </th>

      </tr>
      </thead>

      <tbody id="establecimientos-lista"></tbody>

    </table>
  </div>
<% end %>

<table class="table table-striped table-bordered table-hover">
  <tbody id="establecimientos-111-footer"></tbody>
</table>


<script type="text/javascript">

  $("#form-buscar-establecimientos").bind("submit", function() {

    $('.establecimiento-ubicacion-geografica').html('');
    $("#establecimientos-ubicaciones-geograficas").html('');
    $("#establecimientos-lista").html("<%= escape_javascript("<tr><td colspan='11' style='text-align:center;'>#{image_tag('ajax-loader0.gif')}</td></tr>").html_safe %>")

  })

  $("#form_buscar_establecimientos_anio").bind('change', function() {

    $('.establecimiento-ubicacion-geografica').html('');
    $("#establecimientos-ubicaciones-geograficas").html('');
    $.ajaxQ.abortAll();
    $("#form-buscar-establecimientos").submit();

  })

  $("#form_buscar_establecimientos_programa").bind('change', function() {

    $('.establecimiento-ubicacion-geografica').html('');
    $("#establecimientos-ubicaciones-geograficas").html('');
    $.ajaxQ.abortAll();
    $("#form-buscar-establecimientos").submit();

  })

  $("#form_buscar_establecimientos_proyecto_111").bind('change', function() {

    $('.establecimiento-ubicacion-geografica').html('');
    $("#establecimientos-ubicaciones-geograficas").html('');
    $.ajaxQ.abortAll();
    $("#form-buscar-establecimientos").submit();

  })

  $("#form_buscar_establecimientos_proyecto_111").bind('change', function() {

    $('.establecimiento-ubicacion-geografica').html('');
    $("#establecimientos-ubicaciones-geograficas").html('');
    $.ajaxQ.abortAll();
    $("#form-buscar-establecimientos").submit();

  })

  $(".table-bordered input").bind('change', function() {

    $('.establecimiento-ubicacion-geografica').html('');
    $("#establecimientos-ubicaciones-geograficas").html('');
    $.ajaxQ.abortAll();
    $("#form-buscar-establecimientos").submit();

  })

  function mostrar_mapa(parametros) {

    var tr_size = $.trim($("#establecimientos-ubicaciones-geograficas").html()).length

    $('.establecimientos-ubicaciones-geograficas').remove();

    if (tr_size == 0) {

      $("#link-to-ubicaciones-geograficas").parent().parent().next().after("<tr id=\"establecimientos-ubicaciones-geograficas\" class=\"establecimientos-ubicaciones-geograficas\"></tr>");

      $("#establecimientos-ubicaciones-geograficas").html("<%= escape_javascript("<tr><td colspan='11' style='text-align:center;'>#{image_tag('ajax-loader0.gif')}</td></tr>").html_safe %>")

      $.ajaxQ.abortAll();

      $.ajax({
        type: 'POST',
        url: "<%= url_for(mec_custom_url(data_establecimientos111_ubicaciones_geograficas_url)) %>" + parametros,
        dataType: 'script'
      });

    } else {
      $("#establecimientos-ubicaciones-geograficas").remove();
    }

  }

  function mostrar_establecimientos_instituciones(codigo_establecimiento, anio) {
    if ($('#establecimientos_instituciones').children().length === 0) {
      $.ajax({
        type: 'GET',
        url: '<%= mec_custom_url(data_establecimientos_instituciones_path) %>',
        data: {codigo_establecimiento: codigo_establecimiento,
          periodo: anio
        },
        dataType: 'script'
      });
      $('#ver_instituciones').text('Ocultar Instituciones del Establecimiento');
    } else {
      $('#establecimientos_instituciones').html('');
      $('#ver_instituciones').text('Ver Instituciones del Establecimiento');
    }
    //$('#ocultar_instituciones').toggle();
  }

<% if params[:ce].present? %>

    $("#form_buscar_establecimientos_codigo_establecimiento").val("<%= params[:ce] %>");
    $.ajaxQ.abortAll();
    $("#form-buscar-establecimientos").submit();

<% else %>

    //LIMPIAR FORMULARIO DE BUSQUEDA
    valor_defecto = [{
        id: '#form_buscar_establecimientos_anio',
        valor: 2014
      }];
    resetForm("#form-buscar-establecimientos", valor_defecto);

<% end %>

</script>