<% if directorios_instituciones.present? %>

  <tr id="tab-paginacion">
    <td colspan="19" style="text-align:center;">
      <div class="flickr_pagination"><%= ajax_will_paginate directorios_instituciones, :params => params %>
      </div>
    </td>
  </tr>

  <tr id="tab-cantidad-registros">
    <td colspan="19">Cantidad de registros encontrados: <%= @directorios_instituciones_todos.size %> de <%= @total_registros %>
    </td>
  </tr>

  <tr>

    <%  
      parametros_csv = { :format => 'csv' }
      parametros_csv = parametros_csv.merge(params) 
      parametros_csv_todos = { :format => 'csv', "form_buscar_directorios_instituciones[periodo]" => params[:form_buscar_directorios_instituciones][:periodo]}
    %>

    <% 
      parametros_xls = { :format => 'xlsx'}
      parametros_xls = parametros_xls.merge(params) 
      parametros_xls_todos = { :format => 'xlsx', "form_buscar_directorios_instituciones[periodo]" => params[:form_buscar_directorios_instituciones][:periodo] }
    %>

    <% 
      parametros_json = { :format => 'json' }
      parametros_json = parametros_json.merge(params) 
      parametros_json_todos = { :format => 'json', "form_buscar_directorios_instituciones[periodo]" => params[:form_buscar_directorios_instituciones][:periodo] }
    %>

    <% 
      parametros_pdf = { :format => 'pdf' }
      parametros_pdf = parametros_pdf.merge(params) 
      parametros_pdf_todos = { :format => 'pdf', "form_buscar_directorios_instituciones[periodo]" => params[:form_buscar_directorios_instituciones][:periodo] }
    %>

    <%
      parametros_md5_csv = { :format => 'md5_csv', "form_buscar_directorios_instituciones[periodo]" => params[:form_buscar_directorios_instituciones][:periodo] }
    %>

    <td colspan="12" class="row-descargar">
      
      <%= image_tag "datos-abiertos-nuevo.png", :style => "width:240px; margin-bottom:10px;" %>
      <a href="http://www.w3.org/TR/microdata/"><%= image_tag "microdata-icon.png", id:'tab-microdata', :style => "width:32px; margin-bottom:10px;" %></a>
      <br />

      <% image_star = image_tag('star.png', :style => 'width:12px;padding-bottom:10px;') %>

      <!-- DESCARGAS FILTRADAS -->
      <div id="tab-descargas-filtradas">

        <span data-toggle="tooltip-descarga-filtrada" title="Para las descargas filtradas, mínimamente se debe incluir el filtro por periodo">Descargar Directorio de Instituciones Filtradas:</span>

        <% if params[:form_buscar_directorios_instituciones][:periodo].present? && @directorios_instituciones_todos.size > 0 %>
          <%= link_to "XLS#{image_star * 2}".html_safe, mec_custom_url(data_directorios_instituciones_lista_url(parametros_xls)) , :target => "_target", :style => "margin-left:10px;", :class => 'icon icon-page_excel'%>
          <%= link_to "CSV#{image_star * 3}".html_safe, mec_custom_url(data_directorios_instituciones_lista_url(parametros_csv)) , :targer => "_target", :style => "margin-left:10px;", :class => 'icon icon-page'%>
          <%= link_to "JSON#{image_star * 3}".html_safe, mec_custom_url(data_directorios_instituciones_lista_url(parametros_json)) , :target => "_target", :style => "margin-left:10px;", :class => 'icon icon-page_white_text_width'%>
        <% else %>
          <%= link_to "XLS#{image_star * 2}".html_safe, "#", :onclick => "alert('Para las descargas filtradas, mínimamente se debe incluir el filtro por periodo');return false;", :style => "margin-left:10px;", :class => 'icon icon-page_excel'  %>
          <%= link_to "CSV#{image_star * 3}".html_safe, "#", :onclick => "alert('Para las descargas filtradas, mínimamente se debe incluir el filtro por periodo');return false;", :style => "margin-left:10px;", :class => 'icon icon-page'  %>
          <%= link_to "JSON#{image_star * 3}".html_safe, "#", :onclick => "alert('Para las descargas filtradas, mínimamente se debe incluir el filtro por periodo');return false;", :style => "margin-left:10px;", :class => 'icon icon-page_white_text_width'  %>
        <% end %>

      </div>

      <br /><br />

      <div id="tab-descargas-total">

        <% if params[:form_buscar_directorios_instituciones][:periodo].present? %>

            <!-- DESCARGAS TOTALES -->
            <div style="float:left;" data-toggle="tooltip-descarga-total" title="Las descargas totales se realizan por periodo">Descargar todo el Directorio de Instituciones del año <b><%= params[:form_buscar_directorios_instituciones][:periodo] %></b>:</div>

            <div style="float:left;text-align:center;" itemprop="distribution" itemscope itemtype="https://schema.org/DataDownload">
              <%= descargar_documento(2, params[:form_buscar_directorios_instituciones][:periodo], "0", "xlsx")%>
              <br />
              <meta itemprop="name" content="Directorio de Instituciones Educativas 2012/2014">
              <meta itemprop="description" content="Listado de directorio de instituciones educativas correspondiente al año 2012/2014">
              <meta itemprop="encodingFormat" content="xls">
              <meta itemprop="license" style="display: none;" content="https://creativecommons.org/licenses/by/4.0/legalcode" />
            </div>

            <div style="float:left;text-align:center;" itemprop="distribution" itemscope itemtype="https://schema.org/DataDownload">
              <%= descargar_documento(2, params[:form_buscar_directorios_instituciones][:periodo], "0", "csv")%>
              <br />
              <meta itemprop="name" content="Directorio de Instituciones Educativas 2012/2014">
              <meta itemprop="description" content="Listado de directorio de instituciones educativas correspondiente al año 2012/2014">
              <meta itemprop="encodingFormat" content="csv">
              <meta itemprop="license" style="display: none;" content="https://creativecommons.org/licenses/by/4.0/legalcode" />
            </div>

            <div style="float:left;text-align:center;">
              <%= link_to "MD5/CSV".html_safe, mec_custom_url(data_directorios_instituciones_lista_url( parametros_md5_csv )), :target => "_blank", :style => "margin-left:10px;", :class => 'icon icon-page_md5' %>
            </div>

            <div style="float:left;text-align:center;" itemprop="distribution" itemscope itemtype="https://schema.org/DataDownload">
              <%= descargar_documento(2, params[:form_buscar_directorios_instituciones][:periodo], "0", "json")%>
              <br />
              <meta itemprop="name" content="Directorio de Instituciones Educativas 2012/2014">
              <meta itemprop="description" content="Listado de directorio de instituciones educativas correspondiente al año 2012/2014">
              <meta itemprop="encodingFormat" content="json">
              <meta itemprop="license" style="display: none;" content="https://creativecommons.org/licenses/by/4.0/legalcode" />
            </div>

        <% else %>

          <div class="bg-primary">
            <center><h4>¡Atención! Las descargas <b>totales</b> se realizan por <b>periodo</b></h4></center>
          </div>

        <% end %>

        <div style="clear:both;"></div>

      </div>

    </td>

  </tr>

  <script>
    $('[data-toggle="tooltip-descarga-filtrada"]').tooltip();
    $('[data-toggle="tooltip-descarga-total"]').tooltip();
  </script>

<% end %>
