<%= javascript_include_tag "/assets/views/datos_ver_view.js?body=1" %>
<div>
  <%= link_to ('<i class="icon-py-manual"></i> Ver diccionario').html_safe, mec_custom_url(def_registros_titulos_url), :class => "pull-right btn-lg hidden-xs", :title => "Ir al diccionario" %>
  <!--<div class="pull-right btn-lg hidden-xs" id="start-tour"><a title="Ir a la ayuda"><i class="icon-py-ayuda"></i> Ayuda</a></div>-->
  <h1>
    <span itemprop="name">Registro de T&iacute;tulos</span>
    <meta itemprop="description" content="Se refiere a los Títulos expedidos por el MEC."
          />
    <meta itemprop="url" content="http://datos.mec.gov.py/data/registros_titulos">  
    <meta itemprop="temporal" style="display: none;" content="2012-01-01/2014-12-31"/>
    <span itemprop="catalog" itemscope itemtype="https://schema.org/DataCatalog" style="display: none;">
      <meta itemprop="name" content="Datos Abiertos del Ministerio de Educación y Cultura">
      <meta itemprop="url" content="http://datos.mec.gov.py/">
      <meta itemprop="description" content="Datos Abiertos del Ministerio de Educación y Cultura">
    </span>
    <span itemprop="provider" itemscope itemtype="https://schema.org/Organization" style="display: none;">
      <meta itemprop="name" content="Ministerio de Educación y Cultura">
      <meta itemprop="url" content="http://www.mec.gov.py/">
      <meta itemprop="email" content="datosabiertos@mec.gov.py">
    </span>
    <span itemprop="creator" itemscope itemtype="https://schema.org/Person" style="display: none;">
      <meta itemprop="name" content="Juan Barrios">
      <meta itemprop="email" content="datosabiertos@mec.gov.py">
    </span>
    <meta itemprop="license" style="display: none;" content="https://creativecommons.org/licenses/by/4.0/legalcode"/>
    <meta itemprop="keywords" style="display: none;" content="educación,titulos,carreras"/>
    <meta itemprop="version" style="display: none;" content="1.0"/>
  </h1>
</div>

<%= form_tag mec_custom_url(data_registros_titulos_lista_url(nil,nil)), :remote => true, :id => "form-buscar-registros-titulos" do  %>
  <div class="table-responsive">
    <table class="table table-small-font table-bordered table-striped">
      <thead>
        <tr>

          <th data-priority="1">
            <span data-titulo="true">Año</span>

            <span class="orden">
              <i class="filtro fa fa-sort"></i>
              <i class="descendente fa fa-sort-desc"></i>
              <i class="ascendente fa fa-sort-asc"></i>
            </span>

      <div class="input-group input-group-sm">
        <%= select :form_buscar_registros_titulos, :anio, [nil, 2012, 2013, 2014], {}, {:class => 'form-control input-sm'} %>
      </div>
      </th>

      <th data-priority="1">
        <span data-titulo="true">Mes</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= select :form_buscar_registros_titulos, :mes, options_meses, {}, {:class => 'form-control input-sm'} %>
      </div>
      </th>

      <th data-priority="1">
        <span data-titulo="true">Documento</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_registros_titulos_documento, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-registros-titulos', '#form_buscar_registros_titulos_documento');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_registros_titulos_documento_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :documento, 
            atributo_tipo: :text, 
            model: :RegistroTitulo, 
            limit: 10,
            cadena_consulta: "documento",
            orden: "documento")), 
        parametro_id: "form_buscar_registros_titulos_documento", 
        resultado_id: "form_buscar_registros_titulos_documento_id",
        min_length: 3
        ) %>

      </th>

      <th data-priority="2">
        <span data-titulo="true">Nombre Completo</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_registros_titulos_nombre_completo, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-registros-titulos', '#form_buscar_registros_titulos_nombre_completo');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_registros_titulos_nombre_completo_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :nombre_completo, 
            atributo_tipo: :text, 
            model: :RegistroTitulo, 
            limit: 10,
            cadena_consulta: "nombre_completo",
            orden: "nombre_completo")), 
        parametro_id: "form_buscar_registros_titulos_nombre_completo", 
        resultado_id: "form_buscar_registros_titulos_nombre_completo_id",
        min_length: 3
        ) %>

      </th>

      <th data-priority="2">
        <span data-titulo="true">Carrera</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_registros_titulos_carrera, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-registros-titulos', '#form_buscar_registros_titulos_carrera');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_registros_titulos_carrera_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :carrera, 
            atributo_tipo: :text, 
            model: :RegistroTitulo, 
            limit: 10,
            cadena_consulta: "carrera",
            orden: "carrera")), 
        parametro_id: "form_buscar_registros_titulos_carrera", 
        resultado_id: "form_buscar_registros_titulos_carrera_id",
        min_length: 3
        ) %>

      </th>

      <th data-priority="2">
        <span data-titulo="true">T&iacute;tulo</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_registros_titulos_titulo, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-registros-titulos', '#form_buscar_registros_titulos_titulo');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_registros_titulos_titulo_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :titulo, 
            atributo_tipo: :text, 
            model: :RegistroTitulo, 
            limit: 10,
            cadena_consulta: "titulo",
            orden: "titulo")), 
        parametro_id: "form_buscar_registros_titulos_titulo", 
        resultado_id: "form_buscar_registros_titulos_titulo_id",
        min_length: 3
        ) %>

      </th>

      <th data-priority="3">
        <span data-titulo="true">N&uacute;mero de Resoluci&oacute;n</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_registros_titulos_numero_resolucion, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-registros-titulos', '#form_buscar_registros_titulos_numero_resolucion');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_registros_titulos_numero_resolucion_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :numero_resolucion, 
            atributo_tipo: :int, 
            model: :RegistroTitulo, 
            limit: 10,
            cadena_consulta: "numero_resolucion",
            orden: "numero_resolucion")), 
        parametro_id: "form_buscar_registros_titulos_numero_resolucion", 
        resultado_id: "form_buscar_registros_titulos_numero_resolucion_id",
        min_length: 3
        ) %>

      </th>

      <th data-priority="3">
        <span data-titulo="true">Fecha de Resoluci&oacute;n</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_registros_titulos_fecha_resolucion, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-registros-titulos', '#form_buscar_registros_titulos_fecha_resolucion');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_registros_titulos_fecha_resolucion_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :fecha_resolucion, 
            atributo_tipo: :text, 
            model: :RegistroTitulo, 
            limit: 10,
            cadena_consulta: "fecha_resolucion",
            orden: "fecha_resolucion")), 
        parametro_id: "form_buscar_registros_titulos_fecha_resolucion", 
        resultado_id: "form_buscar_registros_titulos_fecha_resolucion_id",
        min_length: 3
        ) %>

      </th>

      <th data-priority="3">
        <span data-titulo="true">Tipo de Instituci&oacute;n</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_registros_titulos_tipo_institucion, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-registros-titulos', '#form_buscar_registros_titulos_tipo_institucion');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_registros_titulos_tipo_institucion_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :tipo_institucion, 
            atributo_tipo: :text, 
            model: :RegistroTitulo, 
            limit: 10,
            cadena_consulta: "tipo_institucion",
            orden: "tipo_institucion")), 
        parametro_id: "form_buscar_registros_titulos_tipo_institucion", 
        resultado_id: "form_buscar_registros_titulos_tipo_institucion_id",
        min_length: 3
        ) %>

      </th>

      <th data-priority="4">
        <span data-titulo="true">Instituci&oacute;n</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= text_field_tag :form_buscar_registros_titulos_institucion, nil, :class => 'form-control', :placeholder => "" %>
        <span class="input-group-addon limpiar" onclick="quitar_filtro('#form-buscar-registros-titulos', '#form_buscar_registros_titulos_institucion');"><i class="fa fa-times"></i></span>
      </div>

      <%= hidden_field_tag :form_buscar_registros_titulos_institucion_id %>
      <%= autocomplete_help( ruta: mec_custom_url( autocompletar_path(atributo_id: :institucion, 
            atributo_tipo: :text, 
            model: :RegistroTitulo, 
            limit: 10,
            cadena_consulta: "institucion",
            orden: "institucion")), 
        parametro_id: "form_buscar_registros_titulos_institucion", 
        resultado_id: "form_buscar_registros_titulos_institucion_id",
        min_length: 3
        ) %>

      </th>

      <th data-priority="4">
        <span data-titulo="true">Gobierno actual</span>

        <span class="orden">
          <i class="filtro fa fa-sort"></i>
          <i class="descendente fa fa-sort-desc"></i>
          <i class="ascendente fa fa-sort-asc"></i>
        </span>

      <div class="input-group input-group-sm">
        <%= select :form_buscar_registros_titulos, :gobierno_actual, [["Todos", 1], ["Si", 2], ["No", 3]], {}, {:class => 'form-control input-sm'} %>
      </div>
      </th>

      </tr>
      </thead>

      <tbody id="registros-titulos-lista"></tbody>

    </table>
  </div>
<% end %>

<table class="table table-striped table-bordered table-hover">
  <tbody id="registros-titulos-footer"></tbody>
</table>

<script type="text/javascript">

  $("#form-buscar-registros-titulos").bind("submit", function() {

    $("#registros-titulos-lista").html("<%= escape_javascript("<tr><td colspan='11' style='text-align:center;'>#{image_tag('ajax-loader0.gif')}</td></tr>").html_safe %>")
  })

  $(".table-bordered :input").bind('change', function() {
    $.ajaxQ.abortAll();
    $("#form-buscar-registros-titulos").submit();

  })

  function filtrar_gobierno_actual() {

    if ($("#form_buscar_registros_titulos_gobierno_actual").val() == '3') {
      $('#form_buscar_registros_titulos_anio').val('');
      $('#form_buscar_registros_titulos_mes').val('');
      $.ajaxQ.abortAll();
      $("#form-buscar-registros-titulos").submit();
    }

    if ($("#form_buscar_registros_titulos_gobierno_actual").val() == '2') {
      $('#form_buscar_registros_titulos_anio').val('');
      $('#form_buscar_registros_titulos_mes').val('');
      $.ajaxQ.abortAll();
      $("#form-buscar-registros-titulos").submit();
    }

  }

  //LIMPIAR FORMULARIO DE BUSQUEDA
  valor_defecto = null;
  resetForm("#form-buscar-registros-titulos", valor_defecto);

</script>